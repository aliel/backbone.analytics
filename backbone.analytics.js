// Generated by CoffeeScript 1.7.1
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __slice = [].slice;

  window.Backbone.Analytics = (function() {
    function Analytics(options) {
      if (options == null) {
        options = {};
      }
      this.trackNavigate = __bind(this.trackNavigate, this);
      this.setCustomVar = __bind(this.setCustomVar, this);
      this.trackSocial = __bind(this.trackSocial, this);
      this.trackEvent = __bind(this.trackEvent, this);
      this.trackPageview = __bind(this.trackPageview, this);
      this.setAccount = __bind(this.setAccount, this);
      this.push = __bind(this.push, this);
      this.queue = __bind(this.queue, this);
      this.script = __bind(this.script, this);
      this.protocol = __bind(this.protocol, this);
      this.loadScript = __bind(this.loadScript, this);
      this.initialize = __bind(this.initialize, this);
      this.code = options.code;
      this.debug = options.debug;
      if (options.setAccount !== false) {
        this.setAccount();
      }
      if (options.loadScript !== false) {
        this.loadScript();
      }
      this.initialize.apply(this, arguments);
      if (options.initialPageview !== false) {
        this.trackPageview();
      }
      if (options.trackNavigate !== false) {
        this.trackNavigate();
      }
    }

    Analytics.prototype.initialize = function() {};

    Analytics.prototype.loadScript = function() {
      var a, s;
      window.GoogleAnalyticsObject = 'ga';
      a = document.createElement('script');
      a.type = 'text/javascript';
      a.async = true;
      a.src = this.protocol() + this.script();
      s = document.getElementsByTagName('script')[0];
      return s.parentNode.insertBefore(a, s);
    };

    Analytics.prototype.protocol = function() {
      if (document.location.protocol === 'https:') {
        return 'https://ssl';
      } else {
        return 'http://www';
      }
    };

    Analytics.prototype.script = function() {
      if (this.debug === true) {
        return '.google-analytics.com/u/analytics_debug.js';
      } else {
        return '.google-analytics.com/analytics.js';
      }
    };

    Analytics.prototype.queue = function() {
      window.ga = window.ga || function() {
        return (window.ga.q = window.ga.q || []).push(arguments);
      };
      window.ga.l = 1 * new Date();
      return window.ga;
    };

    Analytics.prototype.push = function(args) {
      return this.queue().apply(this, args);
    };

    Analytics.prototype.setAccount = function() {
      if (this.code != null) {
        return this.push(['create', this.code]);
      } else {
        throw new Error("Cannot Set Google Analytics Account: No Tracking Code Provided");
      }
    };

    Analytics.prototype.trackPageview = function(fragment) {
      var command;
      command = ['send', 'pageview'];
      if (fragment != null) {
        command.push(fragment);
      }
      return this.push(command);
    };

    Analytics.prototype.trackEvent = function() {
      var args;
      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      return this.push(['send', 'event'].concat(args));
    };

    Analytics.prototype.trackSocial = function() {
      var args;
      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      return this.push(['send', 'social'].concat(args));
    };

    Analytics.prototype.setCustomVar = function() {
      var args;
      args = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
      return this.push(['set'].concat(args));
    };

    Analytics.prototype.trackNavigate = function() {
      var navigate, trackPageview;
      trackPageview = this.trackPageview;
      navigate = window.Backbone.History.prototype.navigate;
      return window.Backbone.History.prototype.navigate = function(fragment, options) {
        trackPageview(fragment);
        return navigate.apply(this, arguments);
      };
    };

    return Analytics;

  })();

}).call(this);
